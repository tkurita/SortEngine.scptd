<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

  <!-- InstanceBegin template="../../../../../_Templates/helpbook-page-with-applescript.dwt" -->

    <head>
      <meta http-equiv="content-type" content="text/html;charset=utf-8" />
      <title>Usage</title>
      <link href="../01_synopsis/assets/AppleScript.css" rel="stylesheet" type="text/css" media="all" />
      <!-- #BeginHeadLocked "" -->
        <link href="../01_synopsis/assets/helpbook-default.css" type="text/css" rel="stylesheet" media="all" />
        <link href="../01_synopsis/assets/helpbook-navibar.css" type="text/css" rel="stylesheet" media="all" />
        <script type="text/javascript" src="../01_synopsis/assets/navibar-jump.js"></script>
        <link id="helpviewer-handler-helper" href="assets/helpviewer-handler-helper.scpt" />
        <script type="text/javascript" src="assets/helpviewer-handler-enable.js"></script>
      <!-- #EndHeadLocked -->
    </head>

    <body>
      <!-- InstanceBeginEditable name="navi-bar" --><div id="navi-bar"><span class="navibar-item"><a href="../index.html">SortEngine Help</a></span><span class="navibar-item">Usage</span><select onchange="navibarJump(this)"><option value="">§</option>
    <option value="#basic_usage">Basic Usage</option>
    <option value="#tablesort">Table Sort</option>
    <option value="#custom_comparator">Custom Comparator</option>
    <option value="#qsort-vs-bsort">Quick Sort vs Bubble Sort</option></select></div>
<div class="prev-next-item"><a href="../01_synopsis/index.html"><span class="navibar-prev">Synopsis</span></a>|<a href="../03_reference/index.html"><span class="navibar-next">SortEngine Reference</span></a></div><!-- InstanceEndEditable -->
      <div id="contents">
        <!-- InstanceBeginEditable name="Body" -->
          <h1>Usage</h1>
          <h2><a id="basic_usage" name="basic_usage"></a>Basic Usage</h2>
          
          <ol>
            <li>constructor method (<a href="../03_reference/pages/make.html">make</a>, <a href="../03_reference/pages/make_with.html">make_with</a> ) を使って、SortEngine のインスタンスを作る</li>
            <li>必要があれば、ソート順序を設定します。デフォルトは昇順です。
              <ul>
                <li>降順でソートしたいときは、<a href="../03_reference/pages/set_ascending.html">set_ascending</a>(false) をインスタンスに送ります。</li>
              </ul>
            </li>
            <li>1次元リストのソートには、instance method の <a href="../03_reference/pages/sort_list.html">sort_list</a> を引数に与える。</li>
            <li>引数に与えた、リストそのものがソートされます。sort_list からの返り値は、引数に与えたリストと同じ物です。</li>
          </ol>
          
          <div class="sourceCode">
            <div>
              <span class="langKeyword">property</span> <span class="userDefine">SortEngine</span><span class="normal"> : </span><span class="additionCommandName">module</span></div>
            <br />
            <div>
              <span class="additionCommandName">boot</span><span class="normal"> (</span><span class="additionCommandName">module loader</span><span class="normal">) </span><span class="additionCommandName">for</span> <span class="langKeyword">me</span></div>
            <br />
            <div>
              <span class="comment">(* sort a list *)</span></div>
            <div>
              <span class="langKeyword">set</span> <span class="userDefine">a_list</span> <span class="langKeyword">to</span><span class="normal"> {5, 7, 1, 9, 3, 4}</span></div>
            <div>
              <span class="langKeyword">set</span> <span class="userDefine">a_sorter</span> <span class="langKeyword">to</span> <span class="commandName">make</span> <span class="userDefine">SortEngine</span></div>
            <div>
              <span class="commandName">log</span> <span class="userDefine">a_sorter</span><span class="normal">'s </span><span class="userDefine">sort_list</span><span class="normal">(</span><span class="userDefine">a_list</span><span class="normal">)</span></div>
            <div>
              <span class="comment">--result :{1, 3, 4, 5, 7, 9}</span></div>
            <div>
              <span class="commandName">log</span> <span class="userDefine">a_list</span></div>
            <div>
              <span class="comment">-- result : {1, 3, 4, 5, 7, 9}</span></div>
            <br />
            <div>
              <span class="comment">(* reverse sort *)</span></div>
            <div>
              <span class="userDefine">a_sorter</span><span class="normal">'s </span><span class="userDefine">set_ascending</span><span class="normal">(</span><span class="enumeratedValues">false</span><span class="normal">)</span></div>
            <div>
              <span class="commandName">log</span> <span class="userDefine">a_sorter</span><span class="normal">'s </span><span class="userDefine">sort_list</span><span class="normal">(</span><span class="userDefine">a_list</span><span class="normal">)</span></div>
            <div>
              <span class="comment">--result : {9, 7, 5, 4, 3, 1}</span></div>
            <div class="scriptButton">
              <input type="button" value="Basic Usage" onclick="document.location = this.src" src="applescript://com.apple.scripteditor?action=new%26script=property%20SortEngine%20:%20module%0D%0Dboot%20(module%20loader)%20for%20me%0D%0D(*%20sort%20a%20list%20*)%0Dset%20a_list%20to%20%7B5,%207,%201,%209,%203,%204%7D%0Dset%20a_sorter%20to%20make%20SortEngine%0Dlog%20a_sorter%27s%20sort_list(a_list)%0D--result%20:%7B1,%203,%204,%205,%207,%209%7D%0Dlog%20a_list%0D--%20result%20:%20%7B1,%203,%204,%205,%207,%209%7D%0D%0D(*%20reverse%20sort%20*)%0Da_sorter%27s%20set_ascending(false)%0Dlog%20a_sorter%27s%20sort_list(a_list)%0D--result%20:%20%7B9,%207,%205,%204,%203,%201%7D%0D" /></div>
          </div>
          <h2><a id="tablesort" name="tablesort"></a>Table Sort</h2>
          
          <p>2次元のリストを、その中の一つの列に従ってすべてのリストをソートすることができます。2次元リストをソートする時には、<a href="../03_reference/pages/sort_list.html">sort_list</a> の代わりに、<a href="../03_reference/pages/sort_table.html">sort_table</a> に 2次元リストと、ソート順序を決定するリストのインデックスを与えます。</p>
          
          <div class="sourceCode">
            <div>
              <span class="langKeyword">property</span> <span class="userDefine">SortEngine</span> <span class="normal">:</span> <span class="appKeyword">module</span></div>
            <div>
              <span class="appKeyword">boot</span> <span class="normal">(</span><span class="appKeyword">module loader</span><span class="normal">)</span> <span class="appKeyword">for</span> <span class="langKeyword">me</span></div>
            <br />
            <div>
              <span class="langKeyword">set</span> <span class="userDefine">a_sorter</span> <span class="langKeyword">to</span> <span class="appKeyword">make</span> <span class="userDefine">SortEngine</span></div>
            <div>
              <span class="langKeyword">set</span> <span class="userDefine">a_list2d</span> <span class="langKeyword">to</span> <span class="normal">{{&quot;a&quot;,</span> <span class="normal">&quot;b&quot;,</span> <span class="normal">&quot;c&quot;},</span> <span class="normal">{&quot;d&quot;,</span> <span class="normal">&quot;e&quot;,</span> <span class="normal">&quot;f&quot;},</span> <span class="normal">{3,</span> <span class="normal">2,</span> <span class="normal">1}}</span></div>
            <div>
              <span class="userDefine">a_sorter</span><span class="normal">'s</span> <span class="userDefine">sort_table</span><span class="normal">(</span><span class="userDefine">a_list2d</span><span class="normal">,</span> <span class="normal">-1)</span></div>
            <div>
              <span class="normal">--</span><span class="comment">result : {{&quot;c&quot;, &quot;b&quot;, &quot;a&quot;}, {&quot;f&quot;, &quot;e&quot;, &quot;d&quot;}, {1, 2, 3}}</span></div>
            <div class="scriptButton" >
              <input type="button" value="Table Sort" onclick="location.href='applescript://com.apple.scripteditor?action=new%26script=property%20SortEngine%20:%20module%0Dboot%20(module%20loader)%20for%20me%0D%0Dset%20a_sorter%20to%20make%20SortEngine%0Dset%20a_list2d%20to%20%7B%7B%22a%22,%20%22b%22,%20%22c%22%7D,%20%7B%22d%22,%20%22e%22,%20%22f%22%7D,%20%7B3,%202,%201%7D%7D%0Da_sorter%27s%20sort_table(a_list2d,%20-1)%0D--result%20:%20%7B%7B%22c%22,%20%22b%22,%20%22a%22%7D,%20%7B%22f%22,%20%22e%22,%20%22d%22%7D,%20%7B1,%202,%203%7D%7D'" /></div>
          </div>
          <h2><a id="custom_comparator" name="custom_comparator"></a>Custom Comparator</h2>
          
          <p>デフォルトの状態では、AppleScript の比較演算子で扱える値しかソートできません。つまり、数値と文字列のリストしかソートできません。それ以外の値、例えば list や record、script object をソートするときは、その大小関係を定義する script object (comparator script) を与える必要があります。</p>
          
          <p>comparator script は次の仕様を満たしている必要があります。</p>
          <ul>
            <li>二つの引数をとる do ハンドラ持っている。</li>
            <li>do ハンドラは、最初の引数と二つ目の引数を比較し、それぞれの場合に対応して次の値を返す。
              <ul>
                <li>1 : 最初の引数 &gt; 二つ目の引数</li>
                <li>0 : 最初の引数 = 二つ目の引数</li>
                <li>-1 : 最初の引数 &lt; 二つ目の引数</li>
              </ul>
            </li>
          </ul>
          
          <p>comparator script は、construct method <a href="../03_reference/pages/make_with.html">make_with</a> でインスタンスの生成の際に与えるか、instance method <a href="../03_reference/pages/set_comparator.html">set_comparator</a> で instance に設定することができます。</p>
          <p>次のサンプルは、二つの要素からなるリストの要素からなるリストをソートするスクリプトです。リストの最初の要素で大小関係が判定できなければ、二つ目の要素で大小関係を判定します。</p>
          
          <div class="sourceCode">
            <div>
              <span class="langKeyword">property</span> <span class="userDefine">SortEngine</span> <span class="normal">:</span> <span class="appKeyword">module</span></div>
            <div>
              <span class="langKeyword">property</span> <span class="userDefine">loader</span> <span class="normal">:</span> <span class="appKeyword">boot</span> <span class="normal">(</span><span class="appKeyword">module loader</span><span class="normal">)</span> <span class="appKeyword">for</span> <span class="langKeyword">me</span></div>
            <br />
            <div>
              <span class="langKeyword">script</span> <span class="userDefine">ListComparator</span></div>
            <div style="text-indent:4ex;">
              <span class="langKeyword">property</span> <span class="appKeyword">parent</span> <span class="normal">:</span> <span class="userDefine">SortEngine</span><span class="normal">'s</span> <span class="userDefine">base_comparator</span><span class="normal">()</span></div>
            <div style="text-indent:4ex;">
              <span class="langKeyword">property</span> <span class="userDefine">_compare_order</span> <span class="normal">:</span> <span class="normal">{1,</span> <span class="normal">2}</span></div>
            <br />
            <div style="text-indent:4ex;">
              <span class="langKeyword">on</span> <span class="userDefine">do</span><span class="normal">(</span><span class="userDefine">a_first</span><span class="normal">,</span> <span class="userDefine">a_second</span><span class="normal">)</span></div>
            <div style="text-indent:8ex;">
              <span class="langKeyword">repeat</span> <span class="langKeyword">with</span> <span class="userDefine">ith</span> <span class="langKeyword">from</span> <span class="normal">1</span> <span class="langKeyword">to</span> <span class="appKeyword">length</span> <span class="langKeyword">of</span> <span class="langKeyword">my</span> <span class="userDefine">_compare_order</span></div>
            <div style="text-indent:12ex;">
              <span class="langKeyword">set</span> <span class="userDefine">an_index</span> <span class="langKeyword">to</span> <span class="appKeyword">item</span> <span class="userDefine">ith</span> <span class="langKeyword">of</span> <span class="langKeyword">my</span> <span class="userDefine">_compare_order</span></div>
            <div style="text-indent:12ex;">
              <span class="langKeyword">set</span> <span class="userDefine">a_result</span> <span class="langKeyword">to</span> <span class="langKeyword">continue</span> <span class="userDefine">do</span><span class="normal">(</span><span class="appKeyword">item</span> <span class="userDefine">an_index</span> <span class="langKeyword">of</span> <span class="userDefine">a_first</span><span class="normal">,</span> <span class="appKeyword">item</span> <span class="userDefine">an_index</span> <span class="langKeyword">of</span> <span class="userDefine">a_second</span><span class="normal">)</span></div>
            <div style="text-indent:12ex;">
              <span class="langKeyword">if</span> <span class="userDefine">a_result</span> <span class="langKeyword">is</span> <span class="langKeyword">not</span> <span class="normal">0</span> <span class="langKeyword">then</span></div>
            <div style="text-indent:16ex;">
              <span class="langKeyword">exit</span> <span class="langKeyword">repeat</span></div>
            <div style="text-indent:12ex;">
              <span class="langKeyword">end</span> <span class="langKeyword">if</span></div>
            <div style="text-indent:8ex;">
              <span class="langKeyword">end</span> <span class="langKeyword">repeat</span></div>
            <br />
            <div style="text-indent:8ex;">
              <span class="langKeyword">return</span> <span class="userDefine">a_result</span></div>
            <div style="text-indent:4ex;">
              <span class="langKeyword">end</span> <span class="userDefine">do</span></div>
            <div>
              <span class="langKeyword">end</span> <span class="langKeyword">script</span></div>
            <br />
            <div>
              <span class="langKeyword">set</span> <span class="userDefine">a_list</span> <span class="langKeyword">to</span> <span class="normal">{{2,</span> <span class="normal">2},</span> <span class="normal">{1,</span> <span class="normal">2},</span> <span class="normal">{1,</span> <span class="normal">1},</span> <span class="normal">{2,</span> <span class="normal">1}}</span></div>
            <div>
              <span class="langKeyword">set</span> <span class="userDefine">a_sorter</span> <span class="langKeyword">to</span> <span class="userDefine">SortEngine</span><span class="normal">'s</span> <span class="userDefine">make_with</span><span class="normal">({</span><span class="userDefine">comparator</span><span class="normal">:</span><span class="userDefine">ListComparator</span><span class="normal">})</span></div>
            <div>
              <span class="userDefine">a_sorter</span><span class="normal">'s</span> <span class="userDefine">sort_list</span><span class="normal">(</span><span class="userDefine">a_list</span><span class="normal">)</span></div>
            <div>
              <span class="normal">--</span><span class="comment">result :{{1, 1}, {1, 2}, {2, 1}, {2, 2}}</span></div>
            <div class="scriptButton" >
              <input type="button" value="Custom Comparator" onclick="location.href='applescript://com.apple.scripteditor?action=new%26script=property%20SortEngine%20:%20module%0Dproperty%20loader%20:%20boot%20(module%20loader)%20for%20me%0D%0Dscript%20ListComparator%0D%09property%20parent%20:%20SortEngine%27s%20base_comparator()%0D%09property%20_compare_order%20:%20%7B1,%202%7D%0D%09%0D%09on%20do(a_first,%20a_second)%0D%09%09repeat%20with%20ith%20from%201%20to%20length%20of%20my%20_compare_order%0D%09%09%09set%20an_index%20to%20item%20ith%20of%20my%20_compare_order%0D%09%09%09set%20a_result%20to%20continue%20do(item%20an_index%20of%20a_first,%20item%20an_index%20of%20a_second)%0D%09%09%09if%20a_result%20is%20not%200%20then%0D%09%09%09%09exit%20repeat%0D%09%09%09end%20if%0D%09%09end%20repeat%0D%09%09%0D%09%09return%20a_result%0D%09end%20do%0Dend%20script%0D%0Dset%20a_list%20to%20%7B%7B2,%202%7D,%20%7B1,%202%7D,%20%7B1,%201%7D,%20%7B2,%201%7D%7D%0Dset%20a_sorter%20to%20SortEngine%27s%20make_with(%7Bcomparator:ListComparator%7D)%0Da_sorter%27s%20sort_list(a_list)%0D--result%20:%7B%7B1,%201%7D,%20%7B1,%202%7D,%20%7B2,%201%7D,%20%7B2,%202%7D%7D'" /></div>
          </div>
          <h2><a id="qsort-vs-bsort" name="qsort-vs-bsort"></a>Quick Sort vs Bubble Sort</h2>
          
          <p>SortEngine は quick sort と bubble sort のアルゴリズムを内蔵しています。デフォルトの状態では、quick sort が使用されてます。</p>
          <p>一般的に、quick sort は bubble sort よりかなり早いです。しかし、quick sort は安定ソートではありません。どういうことかというと次のサンプルを見てください。ソート前のリストは、二つ目のリストでソートされていると言えます。この2次元リストを最初のリストをキーにしてソートすると、quick sort の場合は、同等な値の順序がソート前後で入れ替わります。例えば、"a" の値の順序が入れ替わることがあります。一方、bubble sort は同等な値の順序は保証されます。用途に応じて使い分けてください。</p>
          
          <div class="sourceCode">
            <div>
              <span class="langKeyword">property</span> <span class="userDefine">SortEngine</span> <span class="normal">:</span> <span class="appKeyword">module</span></div>
            <div>
              <span class="appKeyword">boot</span> <span class="normal">(</span><span class="appKeyword">module loader</span><span class="normal">)</span> <span class="appKeyword">for</span> <span class="langKeyword">me</span></div>
            <br />
            <div>
              <span class="normal">(*</span><span class="comment"> quick sort (default) </span><span class="normal">*)</span></div>
            <div>
              <span class="langKeyword">set</span> <span class="userDefine">a_sorter</span> <span class="langKeyword">to</span> <span class="userDefine">SortEngine</span><span class="normal">'s</span> <span class="userDefine">make_with</span><span class="normal">({</span><span class="userDefine">sorter</span><span class="normal">:&quot;quick&quot;})</span></div>
            <div>
              <span class="langKeyword">set</span> <span class="userDefine">a_list</span> <span class="langKeyword">to</span> <span class="normal">{{&quot;c&quot;,</span> <span class="normal">&quot;a&quot;,</span> <span class="normal">&quot;b&quot;,</span> <span class="normal">&quot;a&quot;,</span> <span class="normal">&quot;c&quot;,</span> <span class="normal">&quot;b&quot;,</span> <span class="normal">&quot;a&quot;},</span> <span class="normal">{1,</span> <span class="normal">1,</span> <span class="normal">1,</span> <span class="normal">2,</span> <span class="normal">2,</span> <span class="normal">2,</span> <span class="normal">3}}</span></div>
            <div>
              <span class="appKeyword">log</span> <span class="userDefine">a_sorter</span><span class="normal">'s</span> <span class="userDefine">sort_table</span><span class="normal">(</span><span class="userDefine">a_list</span><span class="normal">,</span> <span class="normal">1)</span></div>
            <div>
              <span class="normal">--</span><span class="comment"> result :{{a, a, a, b, b, c, c}, {3, 1, 2, 1, 2, 2, 1}}</span></div>
            <br />
            <div>
              <span class="normal">(*</span><span class="comment"> bubble sort </span><span class="normal">*)</span></div>
            <div>
              <span class="langKeyword">set</span> <span class="userDefine">a_sorter</span> <span class="langKeyword">to</span> <span class="userDefine">SortEngine</span><span class="normal">'s</span> <span class="userDefine">make_with</span><span class="normal">({</span><span class="userDefine">sorter</span><span class="normal">:&quot;bubble&quot;})</span></div>
            <div>
              <span class="langKeyword">set</span> <span class="userDefine">a_list</span> <span class="langKeyword">to</span> <span class="normal">{{&quot;c&quot;,</span> <span class="normal">&quot;a&quot;,</span> <span class="normal">&quot;b&quot;,</span> <span class="normal">&quot;a&quot;,</span> <span class="normal">&quot;c&quot;,</span> <span class="normal">&quot;b&quot;,</span> <span class="normal">&quot;a&quot;},</span> <span class="normal">{1,</span> <span class="normal">1,</span> <span class="normal">1,</span> <span class="normal">2,</span> <span class="normal">2,</span> <span class="normal">2,</span> <span class="normal">3}}</span></div>
            <div>
              <span class="appKeyword">log</span> <span class="userDefine">a_sorter</span><span class="normal">'s</span> <span class="userDefine">sort_table</span><span class="normal">(</span><span class="userDefine">a_list</span><span class="normal">,</span> <span class="normal">1)</span></div>
            <div>
              <span class="normal">--</span><span class="comment"> result : {{a, a, a, b, b, c, c}, {1, 2, 3, 1, 2, 1, 2}}</span></div>
            <div class="scriptButton" >
              <input type="button" value="Quicksort vs Bubblesort (stability)" onclick="location.href='applescript://com.apple.scripteditor?action=new%26script=property%20SortEngine%20:%20module%0Dboot%20(module%20loader)%20for%20me%0D%0D(*%20quick%20sort%20(default)%20*)%0Dset%20a_sorter%20to%20SortEngine%27s%20make_with(%7Bsorter:%22quick%22%7D)%0Dset%20a_list%20to%20%7B%7B%22c%22,%20%22a%22,%20%22b%22,%20%22a%22,%20%22c%22,%20%22b%22,%20%22a%22%7D,%20%7B1,%201,%201,%202,%202,%202,%203%7D%7D%0Dlog%20a_sorter%27s%20sort_table(a_list,%201)%0D--%20result%20:%7B%7Ba,%20a,%20a,%20b,%20b,%20c,%20c%7D,%20%7B3,%201,%202,%201,%202,%202,%201%7D%7D%0D%0D(*%20bubble%20sort%20*)%0Dset%20a_sorter%20to%20SortEngine%27s%20make_with(%7Bsorter:%22bubble%22%7D)%0Dset%20a_list%20to%20%7B%7B%22c%22,%20%22a%22,%20%22b%22,%20%22a%22,%20%22c%22,%20%22b%22,%20%22a%22%7D,%20%7B1,%201,%201,%202,%202,%202,%203%7D%7D%0Dlog%20a_sorter%27s%20sort_table(a_list,%201)%0D--%20result%20:%20%7B%7Ba,%20a,%20a,%20b,%20b,%20c,%20c%7D,%20%7B1,%202,%203,%201,%202,%201,%202%7D%7D%0D'" /></div>
          </div>
        <!-- InstanceEndEditable --></div>
      <!-- InstanceBeginEditable name="prev-next-item" --><div class="prev-next-item"><a href="../01_synopsis/index.html"><span class="navibar-prev">Synopsis</span></a>|<a href="../03_reference/index.html"><span class="navibar-next">SortEngine Reference</span></a></div><!-- InstanceEndEditable -->
      <div class="footer">
        <p>This page was last built on <csobj format="MedDate" h="10" region="0" t="DateTime" w="76">Mon, May 28, 2012</csobj> ; <csobj format="LongTime" h="10" region="0" t="DateTime" w="46">9:18:56 AM</csobj> . Thanks for checking it out!</p>
      </div>
    </body>

  <!-- InstanceEnd -->

</html>